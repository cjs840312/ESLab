<html>
   <head>
      <script src="/socket.io/socket.io.js">
      </script>
   </head>
   <body>
      <h1> Chat Room ~ </h1>
      <div id="ChatScreen" style="width:497px;height:200px;border:1px #000000 solid; overflow:auto; white-space: pre-line;word-break: break-all;"></div>

      <br>

      <form method="post">
         <textarea name="text" rows="5" cols="60" id="message"></textarea>
         <input type="button" value="Send" id="SendButton"/>
      </form>


      <script>
         var socket = io.connect();
         var screen = document.getElementById("ChatScreen");

         var myName,receiver
         socket.emit("myHistory",document.cookie);
         socket.on("chatPair",function(Data){
            console.log(Data);
            myName=Data.sender;
            receiver=Data.receiver;
         });
         

         var SendButton= document.getElementById("SendButton");         
         SendButton.addEventListener("click",function(){
            console.log('Sending Message')         
            var message= document.getElementById("message").value;

            socket.emit("Message",{receiver:receiver,"message":message});
            document.getElementById("message").value="";
            screen.textContent +=(myName+": "+message+"\n");
            screen.scrollTop=screen.scrollTopMax;
         });
         
         socket.on("Message",function(Data){
            console.log('Printing Message') 
            var sender=Data.sender 
            var message=Data.message
            screen.textContent +=(sender+": "+message+"\n");
            screen.scrollTop=screen.scrollTopMax;
         });

      </script>

   </body>
</html>